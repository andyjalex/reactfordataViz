{"ast":null,"code":"import * as d3 from 'd3';\nconst MARGIN = {\n  TOP: 10,\n  BOTTOM: 80,\n  LEFT: 70,\n  RIGHT: 10\n};\nconst WIDTH = 600 - MARGIN.LEFT - MARGIN.RIGHT;\nconst HEIGHT = 300 - MARGIN.TOP - MARGIN.BOTTOM;\n\nclass D3Chart {\n  constructor(element, data) {\n    let vis = this;\n    vis.data = data;\n    var xColumn = \"Date\";\n    var yColumn = \"Score\";\n    vis.g = d3.select(element).append(\"svg\").attr(\"width\", WIDTH + MARGIN.LEFT + MARGIN.RIGHT).attr(\"height\", HEIGHT + MARGIN.TOP + MARGIN.BOTTOM).append(\"g\").attr(\"transform\", `translate(${MARGIN.LEFT}, ${MARGIN.TOP})`); //need to clean up data.\n\n    vis.data.forEach(d => {\n      d.year = d.Month.substr(0, 4);\n      d.month = d.Month.substr(5, 2);\n      d.west = Number(d.West_Highland_White_Terrier);\n      d.retriever = Number(d.Golden_Retriever);\n      d.labrador = Number(d.Labrador_Retriever);\n    });\n    vis.data.forEach(d => {\n      d.NewDate = new Date(d.Year, d.Month, '01');\n    });\n    console.log(vis.data); // unpivot the data\n\n    var newArray = [];\n    vis.data.forEach(d => {\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'West',\n        Score: d.west\n      });\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'Retriever',\n        Score: d.retriever\n      });\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'labrador',\n        Score: d.labrador\n      });\n    });\n    console.log(vis.data); //console.log(newArray)\n    // axis groups\n\n    vis.xAxis = vis.g.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", `translate(0, ${HEIGHT})`);\n    vis.yAxis = vis.g.append(\"g\").attr(\"class\", \"y axis\"); // Path generator\n\n    vis.update(newArray);\n  }\n\n  update(data) {\n    let vis = this;\n    var lineColumn = 'Breed';\n    var xColumn = \"Date\";\n    var yColumn = \"Score\"; // scales\n\n    const x = d3.scaleTime().domain(d3.extent(data, d => d.date)).range([0, WIDTH]);\n    const y = d3.scaleLinear().domain([0, d3.max(data, d => d.score)]).range([HEIGHT, 0]); // generate axes once scales have been set\n\n    vis.xAxisCall = d3.axisBottom();\n    vis.xAxis.call(vis.xAxisCall.scale(x));\n    vis.yAxisCall = d3.axisLeft().ticks(6).tickFormat(d3.format('.3s'));\n    vis.yAxis.call(vis.yAxisCall.scale(y)); //console.log(data)\n    //var nested = Array.from(d3.group(data, d => d[lineColumn]),([key, value]) => ({key, value}));\n    //var nested = d3.group(data, d => d[lineColumn])\n\n    var nested = Array.from(d3.group(data, d => d[lineColumn]), _ref => {\n      let [key, value] = _ref;\n      return {\n        key,\n        value\n      };\n    }); //console.log(nested)\n    // set the colour scale\n\n    var color = d3.scaleOrdinal(d3.schemeCategory10);\n    const line = d3.line().x(function (d) {\n      return x(d[xColumn]);\n    }).y(function (d) {\n      return y(d[yColumn]);\n    });\n    nested.forEach(function (d, i) {\n      vis.g.append(\"path\").attr(\"class\", \"chart-line\").style(\"stroke\", function () {\n        // Add the colours dynamically\n        return d.color = color(d.key);\n      }).attr(\"d\", line(d.value));\n    });\n  }\n\n}\n\nexport default D3Chart;","map":{"version":3,"sources":["/Users/andyalexander/Documents/d3/React/reactfordataviz/src/D3Chart.js"],"names":["d3","MARGIN","TOP","BOTTOM","LEFT","RIGHT","WIDTH","HEIGHT","D3Chart","constructor","element","data","vis","xColumn","yColumn","g","select","append","attr","forEach","d","year","Month","substr","month","west","Number","West_Highland_White_Terrier","retriever","Golden_Retriever","labrador","Labrador_Retriever","NewDate","Date","Year","console","log","newArray","push","Breed","Score","xAxis","yAxis","update","lineColumn","x","scaleTime","domain","extent","date","range","y","scaleLinear","max","score","xAxisCall","axisBottom","call","scale","yAxisCall","axisLeft","ticks","tickFormat","format","nested","Array","from","group","key","value","color","scaleOrdinal","schemeCategory10","line","i","style"],"mappings":"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","sourcesContent":["import * as d3 from 'd3'\n\n\nconst MARGIN = { TOP: 10, BOTTOM: 80, LEFT: 70, RIGHT: 10 }\nconst WIDTH = 600 - MARGIN.LEFT - MARGIN.RIGHT\nconst HEIGHT = 300 - MARGIN.TOP - MARGIN.BOTTOM\n\nclass D3Chart {\n\tconstructor(element, data) {\n\t\tlet vis = this\n\n    vis.data = data;\n\t\tvar xColumn = \"Date\"\n\t\tvar yColumn = \"Score\"\n\n\n\n\t\tvis.g = d3.select(element)\n\t\t\t.append(\"svg\")\n\t\t\t\t.attr(\"width\", WIDTH + MARGIN.LEFT + MARGIN.RIGHT)\n\t\t\t\t.attr(\"height\", HEIGHT + MARGIN.TOP + MARGIN.BOTTOM)\n\t\t\t.append(\"g\")\n\t\t\t\t.attr(\"transform\", `translate(${MARGIN.LEFT}, ${MARGIN.TOP})`)\n\n\n\n    //need to clean up data.\n\t\tvis.data.forEach(d => {\n\t    d.year = d.Month.substr(0,4)\n\t\t\td.month = d.Month.substr(5,2)\n\t\t\td.west = Number(d.West_Highland_White_Terrier)\n\t\t\td.retriever = Number(d.Golden_Retriever)\n\t\t\td.labrador = Number(d.Labrador_Retriever)\n\t  })\n\t\tvis.data.forEach(d => {\n\t\t\td.NewDate = new Date(d.Year, d.Month, '01')\n\t\t})\n\t\tconsole.log(vis.data)\n\n\t\t// unpivot the data\n\t\tvar newArray = []\n\t\tvis.data.forEach(d => {\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'West', Score: d.west,})\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'Retriever', Score: d.retriever})\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'labrador', Score: d.labrador})\n\t\t})\n\n\n\t\tconsole.log(vis.data)\n\t\t//console.log(newArray)\n\n\n\n\n\n\t\t// axis groups\n\t\tvis.xAxis = vis.g.append(\"g\")\n\t\t\t.attr(\"class\", \"x axis\")\n\t\t\t.attr(\"transform\", `translate(0, ${HEIGHT})`)\n\t\tvis.yAxis = vis.g.append(\"g\")\n\t\t\t.attr(\"class\", \"y axis\")\n\n\t\t// Path generator\n\n\t\tvis.update(newArray)\n\t}\n\n\tupdate(data) {\n\t\tlet vis = this\n\n\t\tvar lineColumn ='Breed';\n\t\tvar xColumn = \"Date\";\n\t\tvar yColumn = \"Score\";\n\n\t\t// scales\n\t\tconst x = d3.scaleTime()\n\t\t\t.domain(d3.extent(data, d => d.date))\n\t\t\t.range([0, WIDTH])\n\n\t\tconst y = d3.scaleLinear()\n\t\t\t.domain([0, d3.max(data, d => d.score)])\n\t\t\t.range([HEIGHT, 0])\n\n\n\t\t// generate axes once scales have been set\n\t\tvis.xAxisCall = d3.axisBottom()\n\t\tvis.xAxis.call(vis.xAxisCall.scale(x))\n\n\t\tvis.yAxisCall = d3.axisLeft()\n\t\t\t.ticks(6)\n\t\t\t.tickFormat(d3.format('.3s'))\n\t\tvis.yAxis.call(vis.yAxisCall.scale(y))\n\n\t\t//console.log(data)\n\t\t//var nested = Array.from(d3.group(data, d => d[lineColumn]),([key, value]) => ({key, value}));\n\t\t//var nested = d3.group(data, d => d[lineColumn])\n\n\t\tvar nested = Array.from(\n\t\t d3.group(data, d => d[lineColumn]), ([key, value]) => ({key, value})\n\t );\n\t\t//console.log(nested)\n\n\t\t// set the colour scale\n    var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n\n\t\tconst line = d3.line()\n    .x(function(d) { return x(d[xColumn]); })\n    .y(function(d) { return y(d[yColumn]); });\n\n\t\tnested.forEach(function(d,i) {\n\t\t\tvis.g.append(\"path\")\n\t\t\t.attr(\"class\", \"chart-line\")\n\t\t\t.style(\"stroke\", function() { // Add the colours dynamically\n\t\t\t\treturn d.color = color(d.key);\n\t\t\t})\n\t\t\t.attr(\"d\", line(d.value));\n\n\t\t})\n\n\n\t}\n}\n\nexport default D3Chart\n"]},"metadata":{},"sourceType":"module"}