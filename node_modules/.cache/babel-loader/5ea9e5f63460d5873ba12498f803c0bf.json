{"ast":null,"code":"import * as d3 from 'd3';\n\nclass D3Chart {\n  constructor(element, data, breed) {\n    let vis = this;\n    vis.margin = {\n      left: 50,\n      right: 50,\n      top: 10,\n      bottom: 50\n    };\n    vis.data = data;\n    var xColumn = \"Date\";\n    var yColumn = \"Score\";\n    const el = document.getElementById(\"container\");\n    vis.height = 350 - vis.margin.top - vis.margin.bottom;\n    vis.width = 800 - vis.margin.left - vis.margin.right;\n    vis.g = d3.select(\"div#container\").append(\"svg\").attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 \" + (vis.width + vis.margin.left + vis.margin.right) + \" \" + (vis.height + vis.margin.top + vis.margin.bottom)).classed(\"svg-content\", true).append(\"g\").attr(\"transform\", `translate(${vis.margin.left}, ${vis.margin.top})`);\n    var numOfCols = Object.keys(vis.data[0]).length;\n    var numOfDogs = numOfCols - 2; // scales\n\n    vis.x = d3.scaleTime().range([0, vis.width]);\n    vis.y = d3.scaleLinear().range([vis.height, 0]); // axis groups\n\n    vis.xAxis = vis.g.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", `translate(0, ${vis.height})`);\n    vis.yAxis = vis.g.append(\"g\").attr(\"class\", \"y axis\"); // Path generator\n\n    console.log(breed);\n    vis.update(vis.data, breed);\n  }\n\n  update(data, breed) {\n    let vis = this;\n    vis.g.attr('height', '500px').attr('width', vis.width); //simplify to an array\n\n    var breedArray = breed.map(obj => {\n      return obj.value;\n    });\n    data.forEach(d => {\n      d.year = d.Month.substr(0, 4);\n      d.month = d.Month.substr(5, 2);\n      d.west = Number(d.West_Highland_White_Terrier);\n      d.retriever = Number(d.Golden_Retriever);\n      d.labrador = Number(d.Labrador_Retriever);\n      d.dalmatian = Number(d.Dalmatian);\n      d.cockapoo = Number(d.Cockapoo); // d.labrador = Number(d.Labrador)\n    });\n    data.forEach(d => {\n      d.NewDate = new Date(d.year, d.month, '01');\n    }); // unpivot the data\n\n    var newArray = [];\n    data.forEach(d => {\n      //needs to be refactored to be dynamic\n      //loop for var numOfDogs\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'West Highland Terrier',\n        Score: d.west\n      });\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'Retriever',\n        Score: d.retriever\n      });\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'Labrador',\n        Score: d.labrador\n      });\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'Dalmatian',\n        Score: d.dalmatian\n      });\n      newArray.push({\n        Date: d.NewDate,\n        Breed: 'Cockapoo',\n        Score: d.cockapoo\n      });\n    });\n    const newData = newArray.filter(item => breedArray.includes(item.Breed));\n    newData.forEach(d => {\n      if (d.Score !== d.Score) {\n        d.Score = 0;\n      }\n    });\n    console.log(newData);\n    var lineColumn = 'Breed';\n    var xColumn = \"Date\";\n    var yColumn = \"Score\";\n    vis.y.domain([0, d3.max(newData, d => d.Score)]);\n    vis.x.domain(d3.extent(newData, d => d.Date)); // generate axes once scales have been set\n\n    vis.xAxisCall = d3.axisBottom();\n    vis.xAxis.call(vis.xAxisCall.scale(vis.x));\n    vis.yAxisCall = d3.axisLeft().ticks(6).tickFormat(d3.format('.3s'));\n    vis.yAxis.call(vis.yAxisCall.scale(vis.y));\n    var nested = Array.from(d3.group(newData, d => d[lineColumn]), _ref => {\n      let [key, value] = _ref;\n      return {\n        key,\n        value\n      };\n    }); //console.log(nested)\n    // set the colour scale\n\n    var color = d3.scaleOrdinal(d3.schemeCategory10); // spacing for the legend\n\n    var legendSpace = vis.width / nested.length; //nested.map((i) => console.log(i.value));\n\n    var paths = vis.g.selectAll('.lineTest').data(nested, d => d.Breed);\n    console.log(paths);\n    paths.exit().transition().duration(500).remove(); // //update\n    // paths.transition().duration(500)\n    // .attr(\"d\", function(d){\n    // \t\t\t\treturn d3.line()\n    // \t\t\t\t.x(function(d) { return vis.x(d[xColumn]); })\n    // \t\t\t\t.y(function(d) { return vis.y(d[yColumn]) })\n    // \t\t\t\t(d.value)\n    // \t\t\t})\n    //enter\n\n    paths.enter().append(\"path\").attr(\"fill\", \"none\").attr(\"stroke\", function (d) {\n      return color(d.key);\n    }).attr(\"stroke-width\", 2).attr(\"class\", \"lineTest\").merge(paths).transition().duration(1000).attr(\"stroke\", function (d) {\n      return color(d.key);\n    }).attr(\"d\", function (d) {\n      return d3.line().x(function (d) {\n        return vis.x(d[xColumn]);\n      }).y(function (d) {\n        return vis.y(d[yColumn]);\n      })(d.value);\n    });\n    vis.g.selectAll('.legend').remove();\n    const legends = vis.g.selectAll('.legend').data(nested, function (d) {\n      return d.key; // always try and use a key function to uniquely identify\n    });\n    legends.enter().append(\"text\").attr(\"x\", function (d, i) {\n      return legendSpace / 2 + i * legendSpace;\n    }) // space legend\n    .attr(\"y\", vis.height + vis.margin.bottom / 2 + 20).attr(\"class\", \"legend\") // style the legend\n    .style(\"fill\", function (d) {\n      // Add the colours dynamically\n      return d.color = color(d.key);\n    }).text(function (d) {\n      return d.key;\n    }); // nested.forEach(function(d,i) {\n    // \t// Add the Legend\n    //   vis.g.append(\"text\")\n    //       .attr(\"x\", (legendSpace/2)+i*legendSpace)  // space legend\n    //       .attr(\"y\", HEIGHT + (MARGIN.BOTTOM/2)+ 5)\n    //       .attr(\"class\", \"legend\")    // style the legend\n    //       .style(\"fill\", function() { // Add the colours dynamically\n    //           return d.color = color(d.key); })\n    //       .text(d.key);\n    // })\n  }\n\n}\n\nexport default D3Chart;","map":{"version":3,"sources":["/Users/andyalexander/Documents/d3/React/reactfordataviz/src/components/D3Chart.js"],"names":["d3","D3Chart","constructor","element","data","breed","vis","margin","left","right","top","bottom","xColumn","yColumn","el","document","getElementById","height","width","g","select","append","attr","classed","numOfCols","Object","keys","length","numOfDogs","x","scaleTime","range","y","scaleLinear","xAxis","yAxis","console","log","update","breedArray","map","obj","value","forEach","d","year","Month","substr","month","west","Number","West_Highland_White_Terrier","retriever","Golden_Retriever","labrador","Labrador_Retriever","dalmatian","Dalmatian","cockapoo","Cockapoo","NewDate","Date","newArray","push","Breed","Score","newData","filter","item","includes","lineColumn","domain","max","extent","xAxisCall","axisBottom","call","scale","yAxisCall","axisLeft","ticks","tickFormat","format","nested","Array","from","group","key","color","scaleOrdinal","schemeCategory10","legendSpace","paths","selectAll","exit","transition","duration","remove","enter","merge","line","legends","i","style","text"],"mappings":"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","sourcesContent":["import * as d3 from 'd3'\n\n\n\nclass D3Chart {\n\tconstructor(element, data, breed) {\n\t\tlet vis = this\n\n\t\tvis.margin = {\n      left: 50,\n      right: 50,\n      top: 10,\n      bottom: 50\n    }\n\n\n    vis.data = data;\n\t\tvar xColumn = \"Date\"\n\t\tvar yColumn = \"Score\"\n\n\t\tconst el = document.getElementById(\"container\")\n\t\tvis.height = 350 - vis.margin.top - vis.margin.bottom\n\t\tvis.width = 800 - vis.margin.left - vis.margin.right\n\n\n\t\tvis.g = d3.select(\"div#container\")\n\t\t\t.append(\"svg\")\n\t\t\t.attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n\t\t\t.attr(\"viewBox\", \"0 0 \" + (vis.width + vis.margin.left + vis.margin.right) + \" \" + (vis.height + vis.margin.top + vis.margin.bottom))\n\t\t\t.classed(\"svg-content\", true)\n\t\t\t.append(\"g\")\n\t\t\t\t.attr(\"transform\", `translate(${vis.margin.left}, ${vis.margin.top})`)\n\n\t\tvar numOfCols = Object.keys(vis.data[0]).length\n\n\t\tvar numOfDogs = numOfCols-2\n\n\t\t// scales\n\t\tvis.x = d3.scaleTime()\n\t\t\t.range([0, vis.width])\n\n\t\tvis.y = d3.scaleLinear()\n\t\t\t.range([vis.height, 0])\n\n\t\t// axis groups\n\t\tvis.xAxis = vis.g.append(\"g\")\n\t\t\t.attr(\"class\", \"x axis\")\n\t\t\t.attr(\"transform\", `translate(0, ${vis.height})`)\n\t\tvis.yAxis = vis.g.append(\"g\")\n\t\t\t.attr(\"class\", \"y axis\")\n\n\t\t// Path generator\n\t\tconsole.log(breed)\n\t\tvis.update(vis.data, breed)\n\t}\n\n\tupdate(data, breed) {\n\t\tlet vis = this\n\n\t\tvis.g\n\t\t.attr('height', '500px')\n\t\t.attr('width', vis.width)\n\n\t\t//simplify to an array\n\t\tvar breedArray = breed.map((obj) => {\n\t\t\treturn obj.value\n\t\t})\n\t\tdata.forEach(d => {\n\t    d.year = d.Month.substr(0,4)\n\t\t\td.month = d.Month.substr(5,2)\n\t\t\td.west = Number(d.West_Highland_White_Terrier)\n\t\t\td.retriever = Number(d.Golden_Retriever)\n\t\t\td.labrador = Number(d.Labrador_Retriever)\n\t\t\td.dalmatian = Number(d.Dalmatian)\n\t\t\td.cockapoo = Number(d.Cockapoo)\n\t\t\t// d.labrador = Number(d.Labrador)\n\t  })\n\t\tdata.forEach(d => {\n\t\t\td.NewDate = new Date(d.year, d.month, '01')\n\t\t})\n\n\t\t// unpivot the data\n\t\tvar newArray = []\n\t\tdata.forEach(d => {\n\t\t\t//needs to be refactored to be dynamic\n\t\t\t//loop for var numOfDogs\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'West Highland Terrier', Score: d.west})\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'Retriever', Score: d.retriever})\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'Labrador', Score: d.labrador})\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'Dalmatian', Score: d.dalmatian})\n\t\t\tnewArray.push({Date: d.NewDate, Breed: 'Cockapoo', Score: d.cockapoo})\n\t\t})\n\n\t\tconst newData = newArray.filter(item => breedArray.includes(item.Breed))\n\n\t\tnewData.forEach(d => {\n\t\t\tif(d.Score !== d.Score){\n    \t\td.Score = 0;\n\t\t\t}\n\t\t});\n\n\n\t\tconsole.log(newData)\n\n\n\t\tvar lineColumn ='Breed';\n\t\tvar xColumn = \"Date\";\n\t\tvar yColumn = \"Score\";\n\n\t\tvis.y.domain([0, d3.max(newData, d => d.Score)])\n\t\tvis.x.domain(d3.extent(newData, d => d.Date))\n\n\t\t// generate axes once scales have been set\n\t\tvis.xAxisCall = d3.axisBottom()\n\t\tvis.xAxis.call(vis.xAxisCall.scale(vis.x))\n\n\t\tvis.yAxisCall = d3.axisLeft()\n\t\t\t.ticks(6)\n\t\t\t.tickFormat(d3.format('.3s'))\n\t\tvis.yAxis.call(vis.yAxisCall.scale(vis.y))\n\n\t\tvar nested = Array.from(\n\t\t d3.group(newData, d => d[lineColumn]), ([key, value]) => ({key, value})\n\t );\n\t\t//console.log(nested)\n\n\t\t// set the colour scale\n    var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n\t\t// spacing for the legend\n\t\tvar legendSpace = vis.width/nested.length;\n\n\t\t//nested.map((i) => console.log(i.value));\n\n\t\tvar paths = vis.g.selectAll('.lineTest')\n\t\t.data(nested, d => d.Breed)\n\n\t\tconsole.log(paths)\n\t\tpaths.exit().transition().duration(500).remove()\n\n\t\t// //update\n\t\t// paths.transition().duration(500)\n\t\t// .attr(\"d\", function(d){\n\t\t// \t\t\t\treturn d3.line()\n\t\t// \t\t\t\t.x(function(d) { return vis.x(d[xColumn]); })\n\t\t// \t\t\t\t.y(function(d) { return vis.y(d[yColumn]) })\n\t\t// \t\t\t\t(d.value)\n\t\t// \t\t\t})\n\t\t//enter\n\t\tpaths.enter().append(\"path\")\n\t\t\t.attr(\"fill\", \"none\")\n\t\t\t.attr(\"stroke\", function(d){ return color(d.key) })\n\t\t\t.attr(\"stroke-width\", 2)\n\t\t\t.attr(\"class\",\"lineTest\")\n\t\t\t.merge(paths)\n\t\t\t.transition()\n    .duration(1000)\n\t\t\t.attr(\"stroke\", function(d){ return color(d.key) })\n\t\t\t.attr(\"d\", function(d){\n        return d3.line()\n          .x(function(d) { return vis.x(d[xColumn]); })\n          .y(function(d) { return vis.y(d[yColumn]) })\n          (d.value)\n      })\n\n\n\n\t\tvis.g.selectAll('.legend').remove()\n\t\tconst legends = vis.g.selectAll('.legend')\n\t\t.data(nested, function(d){\n    return d.key; // always try and use a key function to uniquely identify\n  \t});\n\n\t\tlegends.enter().append(\"text\")\n\t\t\t.attr(\"x\", function(d, i){ return (legendSpace/2)+i*legendSpace})  // space legend\n\t      .attr(\"y\", vis.height + (vis.margin.bottom/2)+ 20)\n\t      .attr(\"class\", \"legend\")    // style the legend\n\t      .style(\"fill\", function(d) { // Add the colours dynamically\n\t          return d.color = color(d.key); })\n\t      .text(function(d){return d.key;})\n\n\n\t\t// nested.forEach(function(d,i) {\n\t\t// \t// Add the Legend\n    //   vis.g.append(\"text\")\n    //       .attr(\"x\", (legendSpace/2)+i*legendSpace)  // space legend\n    //       .attr(\"y\", HEIGHT + (MARGIN.BOTTOM/2)+ 5)\n    //       .attr(\"class\", \"legend\")    // style the legend\n    //       .style(\"fill\", function() { // Add the colours dynamically\n    //           return d.color = color(d.key); })\n    //       .text(d.key);\n\t\t// })\n\n\t}\n}\n\nexport default D3Chart\n"]},"metadata":{},"sourceType":"module"}